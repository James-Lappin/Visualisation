@{
    Layout = null;
}

<title>Simple Map</title>
<meta name="viewport" content="initial-scale=1.0">
<meta charset="utf-8">
<style>
    html, body {
        height: 100%;
        margin: 0;
        padding: 0;
    }

    #map {
        height: 100%;
    }
</style>

<!--Script references. -->
<!--The jQuery library is required and is referenced by default in _Layout.cshtml. -->
<script src="~/Scripts/jquery-1.10.2.min.js"></script>
<!--Reference the SignalR library. -->
<script src="~/Scripts/jquery.signalR-2.2.0.min.js"></script>

<!--Reference the autogenerated SignalR hub script. -->
<script src="~/signalr/hubs"></script>


<div id="map"></div>
<script>
    var map;
    function initMap() {
        var mapStyles = [
            {
                featureType: "all",
                elementType: "labels",
                stylers: [
                    { visibility: "off" }
                ]
            }
        ];

        map = new google.maps.Map(document.getElementById('map'), {
            center: { lat: 54.559322, lng: -4.174804 },
            zoom: 6,
            styles: mapStyles,
            draggable: false,
            zoomControl: false,
            scrollwheel: false,
            disableDoubleClickZoom: true
        });
    }

    function drawOnMap(lat, long) {
        console.log("Drawing, lat: " + lat + " long: " + long);
        var point = new google.maps.LatLng(parseFloat(lat), parseFloat(long));
        var marker = new google.maps.Marker({
            map: map,
            position: point
        });

        setTimeout(function clearMarker() {
            marker.setMap(null);
        }, 2000);
    }

    

    $(function () {
        // Create a function that the hub can call back to display messages.
        var mapHub = $.connection.mapHub;
        mapHub.client.displayLocation = function (lat, long) {
            console.log("hub called");
            drawOnMap(lat, long);
        };
        $.connection.hub.start().done(function () {
            console.log("started");
        });
    });
    
</script>
<script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyD1w_OoKdB1llofVR93s5JSwGKLm4YFlHs&callback=initMap"
        async defer></script>



   